---
title: 'Pricing Changesâ€™ Effects on Mobile Revenue '
author: ''
date: '2018-12-05'
slug: pricing-changes-effects-on-mobile-revenue
categories: []
tags: []
---

On March 22, 2018 we renamed the Awesome Plan to the Pro Plan, and changed its price from \$10/mo to \$15/mo. We announced the change and offered a promotion to let users lock in the \$10/mo. price one month earlier, on February 22.

In this analysis we'll analyze the effect that the price change has had on _mobile_ revenue. In our previous analyses we've focused only on Stripe revenue and overlooked mobile. This analysis is at least 6 months late, but better late than never.

We'll utilize the Causal Impact package to estimate what MRR would have been without the price change and calculate the effect size from there. It's important to note that the effect of the annual plan promotion likely interacts with the effect of the price change, so any effect on MRR will have come as a result of both events.

## Summary
We seems to have underestimated the impact that the price change would have on mobile revenue. The impact on mobile is very different than that on web-based revenue. Perhaps people are more sensitive to price differences when paying for something in the mobile app stores. The cumulative effect of the price changes on mobile revenue seems to be somewhere around a \$20K loss in MRR.

```{r include = FALSE, message = FALSE, warning = FALSE}
# load libraries
library(buffer)
library(dplyr)
library(CausalImpact)
library(ggplot2)
library(scales)

# buffer ggplot theme
buffer_theme <- function() {
  theme_minimal(base_family = "Roboto Condensed") +
    theme(plot.title = element_text(size = rel(1.5), face = "bold"),
          plot.subtitle = element_text(size = rel(1.1)),
          plot.caption = element_text(color = "#777777", vjust = 0),
          axis.title = element_text(size = rel(.9), hjust = 0.95, face = "italic"),
          panel.grid.major = element_line(size = rel(.1), color = "#000000"),
          panel.grid.minor = element_line(size = rel(.05), color = "#000000"),
          plot.background = element_rect(fill = '#F5F5F5', color = '#F5F5F5'),
          panel.background = element_rect(fill = '#F5F5F5', color = '#F5F5F5'))
}
```

We'll collect mobile MRR data for all dates since June 2017.

```{r include = FALSE, eval = FALSE}
# connect to redshift
con <- redshift_connect()
```

```{sql eval = FALSE}
select
  date(date) as date
  , plan_id
  , gateway
  , billing_cycle
  , total_mrr
from dbt.daily_mrr_values
where gateway in ('Apple', 'Android')
and date >= '2017-06-01'
```

```{r include = FALSE}
# save data
# saveRDS(mobile_mrr, file = 'mobile_mrr.rds')
mobile_mrr <- readRDS('mobile_mrr.rds')
```

Now that we've collected the data, let's plot mobile MRR over the course of 2018.

```{r echo = FALSE}
# plot mrr over time
mobile_mrr %>% 
  group_by(date, gateway) %>% 
  summarise(mrr = sum(total_mrr)) %>% 
  ggplot(aes(x = date, y = mrr, color = gateway)) +
  geom_line(size = 1) +
  geom_vline(xintercept = as.numeric(as.Date("2018-03-22")), linetype = 2, color = 'red') +
  buffer_theme() +
  theme(legend.position = "none") +
  scale_y_continuous(labels = dollar) +
  facet_wrap(~gateway, scales = "free") +
  labs(x = NULL, y = NULL, title = "Android and iOS MRR", subtitle = "All Subscriptions")
```

Oh dear. The red dotted line represents the date that the price change fully went into effect. Although revenue growth was already slowing down for Android and Apple, the price change seems to have had quite a negative effect.

```{r echo = FALSE}
# plot mrr over time
mobile_mrr %>%
  filter(billing_cycle == "month") %>% 
  group_by(date, gateway) %>% 
  summarise(mrr = sum(total_mrr)) %>% 
  ggplot(aes(x = date, y = mrr, color = gateway)) +
  geom_line(size = 1) +
  geom_vline(xintercept = as.numeric(as.Date("2018-03-22")), linetype = 2, color = 'red') +
  buffer_theme() +
  theme(legend.position = "none") +
  scale_y_continuous(labels = dollar) +
  facet_wrap(~gateway, scales = "free") +
  labs(x = NULL, y = NULL, title = "Android and iOS MRR", subtitle = "Monthly Subscriptions")
```

## Measuring the Effect on MRR
We'll use a technique called Causal Impact for causal inference. Essentially, we take MRR growth before the pricing change and forecast it into the future, and compare the forecast with the observed values. The difference between the counterfactual (what MRR growth would have happened without the pricing change) and the observed MRR growth numbers is our estimated effect size.

We'll also try to isolate the effect of the price change by excluding the weeks during which the promotional offer had a large effect. We do this by defining the "post-intervention period" as the weeks from April 2 onwards.

The "pre-intervention period"" includes dates from June 1, 2017 to the week of February 26, which is the week that we announced the price change and the offer to lock in the lower prices. We use the average MRR growth from the dates in the pre-intervention period to create our forecast of what MRR growth would have looked like without the pricing change. In this case, the simple average of is used.

**_You'll notice that we've left out a few weeks in March. The weeks of March 19 and March 26 saw unusually high MRR growth, and it's my assumption is that this was primarily due to our offer to let users lock in the lower prices. We'll use the weeks outside of this time window for our analysis_**.

To perform inference, we run the analysis using the `CausalImpact` command.

```{r include = FALSE}
# load zoo package
library(zoo)

# calculate mrr by day
by_day <- mobile_mrr %>% 
  group_by(date) %>% 
  summarise(total_mrr = sum(total_mrr)) %>% 
  mutate(mrr_change = total_mrr - lag(total_mrr, 1)) %>% 
  filter(date != min(date) & date != max(date))

# create time series object
mrr_ts <- zoo(by_day$mrr_change, by_day$date)

# specify the pre and post periods
pre.period <- as.Date(c("2017-06-02", "2018-02-26"))
post.period <- as.Date(c("2018-04-02", "2018-12-02"))
```

```{r warning = FALSE, message = FALSE}
# run analysis
impact <- CausalImpact(mrr_ts, pre.period, post.period, model.args = list(niter = 5000))

# plot impact
plot(impact) +
  labs(title = "Impact on Mobile MRR", subtitle = "Estimated Cumulative Loss of $20K in MRR") +
  scale_y_continuous(labels = dollar) +
  buffer_theme()
```

The pre-intervention period includes all data to the left of the first vertical dotted line, and the post-intervention period includes all data to the right of the second vertical dotted line. 

The top panel in the graph shows the actual observed data (the black line) as well as the counterfactual, which is our best guess at what daily MRR growth would have been had we not introduced a new plan. 

The second panel displays the estimated effect that the price change had on MRR growth each day, and the bottom panel shows the cumulative effect over time on daily MRR growth. 

Because there are so many points, it's difficult to see the pointwise estimates, i.e. the the estimated change in daily MRR growth for each day. The cumulative effect of these daily changes in MRR growth can be clearly seen in the bottom panel however. The cumulative effect appears to be somewhere around a \$20 thousand loss in MRR.

Lets's look at the summary of our causal impact model.

```{r}
# get summary
summary(impact)
```

The probability of a true causal effect is well over 99%. Average daily MRR growth for the mobile apps was \$44 per day before February 26, and -\$34 per day for the dates following March 26. This equates a relative effect of around -177%. 
